## **第 5 集：工程协作的核心——Git 与版本控制**

### **一、为什么 (Why)：为什么要使用 Git？**

“前面我们搭建了高性能终端 **Cmder/MSYS2**，但我们的代码还只是在本地硬盘里。要进入真正的工程协作，我们必须解决 **代码管理和历史记录** 的难题。”

“回忆一下你可能经历过的痛苦场景：”

1.  **版本混乱：** 你创建了 `model_v1_final.go`、`model_v2_final_really.go` 这样的文件地狱，不知道哪个是最新可用的版本。
2.  **回溯绝望：** 代码上线后发现一个 Bug，但你完全不知道是**哪一次修改**引入的，无法快速回滚到前一个稳定版本。
3.  **协作冲突：** 当你和同事修改同一个文件时，互相覆盖了对方的代码，导致巨大的返工。

“**我们的目标：** 我们需要一个专业的工具，能够**记录代码的每一次修改历史**，**方便地切换到任何历史版本**，并能**高效地支持多人并行开发**。这个工具，就是工程界的标准：**Git**。”

-----

### **二、Git 是什么？(What)**

“**Git 是一种分布式版本控制系统 (Distributed Version Control System, DVCS)。** 它解决了我们所有关于代码历史和协作的痛点。”

#### **1. 核心理念：快照系统与分布式**

  * **快照系统（Snapshot）：** 传统的版本控制系统只存储文件间的**差异（Deltas）**。而 Git 存储的是一个项目在特定时间点的**完整快照（Snapshot）**。这使得查看历史版本和切换分支的速度极快，因为 Git 不需要层层重建文件。
  * **分布式：** Git 是为高性能、分布式协作而设计的（由 Linux 之父 Linus Torvalds 在两周内编写）。每个开发者都有**完整的代码仓库历史记录**，不依赖中央服务器，这意味着你可以在断网的情况下工作和提交。

#### **2. Git 的三大工作区域与状态**

理解 Git，必须理解它的 **“三区三状态”**。这是 Git 操作的核心：

| 状态 (State) | 对应区域 (Area) | 描述 (What) | 操作 (How) |
| :--- | :--- | :--- | :--- |
| **已修改** (Modified) | **工作区 (Working Directory)** | 你当前看到的、正在编辑的代码文件。 | 编辑文件 |
| **已暂存** (Staged) | **暂存区 (Staging Area)** | 标记了你希望包含在下一次提交中的那些修改。 | `git add` |
| **已提交** (Committed) | **Git 仓库 (Repository)** | 数据已经安全地保存在本地数据库中，作为一个历史版本。 | `git commit` |

“**暂存区**是 Git 最独特的设计。它允许你细致地挑选哪些修改应该被打包成一个逻辑提交，而不是一股脑地提交所有修改。”

-----

### **三、怎么做 (How)：安装与核心工作流**

#### **A. 安装 Git for Windows**

“为了在 Windows 上获得最好的体验，我们安装官方的 **Git for Windows**，它提供了 Bash 模拟环境和必要的底层工具。”

1.  **下载：** 访问 Git 官网 (`git-scm.com`)，下载最新版本的 Git for Windows 安装程序。

2.  **安装：** 双击安装程序。在安装过程中，大多数选项保持默认即可。

3.  **验证：** 安装完成后，打开你首选的终端（Cmder 或 Windows Terminal），输入以下命令：

    ```bash
    git --version
    ```

    如果显示出 Git 的版本号，则说明安装成功。

#### **B. 配置身份（一次性）**

“这是你提交代码时的署名信息。**在全球范围内，你需要用它来标记你的每一次代码贡献。**”

```bash
git config --global user.name "你的名字"
git config --global user.email "你的邮箱"
```

#### **C. 核心操作三步走（工作流）**

“Git 的核心工作流是线性的：**修改 -\> 暂存 -\> 提交。**”

1.  **初始化仓库：** 在你的项目目录（如 `energy_model` 文件夹）中，创建一个新的 Git 仓库。
    ```bash
    git init
    ```
2.  **修改文件：** 在工作区修改 `main.go` 文件。
3.  **查看状态：** 检查哪些文件被修改了。
    ```bash
    git status
    ```
4.  **添加到暂存区（`git add`）：** 将你希望提交的修改标记为“准备提交”。
    ```bash
    git add main.go  # 或 git add . 添加所有修改
    ```
5.  **提交到本地仓库（`git commit`）：** 将暂存区的修改永久保存到本地历史记录中。**提交信息（Commit Message）必须清晰描述你做了什么。**
    ```bash
    git commit -m "feat: 完成光伏模型数据读取功能"
    ```

#### **D. 高级命令（时间旅行与协作）**

| 命令 | 动作 | 描述 |
| :--- | :--- | :--- |
| **`git log`** | 查看历史 | 查看所有提交（快照）的历史记录。 |
| **`git checkout <branch/commit>`** | 切换/回滚 | 切换到历史上的某个提交或分支，实现“时间旅行”。 |
| **`git branch <name>`** | 分支 | 创建一个新的分支，用于并行开发。 |
| **`git push`** | 推送 | 将本地的提交上传到远程仓库（如 GitHub）。 |
| **`git pull`** | 拉取 | 从远程仓库下载最新的代码和提交。 |

-----

### **四、Git 有何用？(So What)：工程中的价值**

“在我们的能源数字化工程中，Git 不仅仅是工具，它是**项目管理和团队协作的基石**。”

1.  **完整的可回溯性：** 任何时候发现 Bug，都可以使用 `git log` 查看历史，并使用 `git checkout` **一键回滚**到任何一个稳定版本。这是项目稳定的最终保障。
2.  **并行开发（分支 Branch）：** Git 允许团队成员在\*\*分支（Branch）\*\*上独立开发新功能或修复 Bug，而不会影响主线代码的稳定性。
3.  **连接 GitHub/GitLab：** Git 是本地工具，而 **GitHub** 等平台是**远程仓库托管中心**。它们提供了备份、共享、以及 **Pull Request (PR)** 等代码审查功能，是团队协作的中心。

“**Git 是我们打造掘金铲，实现团队高效、稳定协作的唯一标准。** 